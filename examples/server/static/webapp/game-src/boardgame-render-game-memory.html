<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="boardgame-memory-card.html">

<dom-module id="boardgame-render-game-memory">
  <template>
    <style>
      .card {
        position: relative;
        height:3em;
        width:4em;
        background-color:#009999;
      }

    </style>
    <h2>Memory</h2>
    <template is="dom-repeat" items="{{expandedState.Players}}">
      <div>
        <span>Player {{index}}: {{item.WonCards.length}}</span> <span>{{IsCurrentPlayer(index)}}</span>
      </div>
    </template>
    <template is="dom-repeat" items="{{computedCards}}">
        {{index}}
        <boardgame-memory-card rank="{{item.Values.Type}}" hidden="{{!Exists(item.Values)}}" spacer="{{!Exists(item)}}"></boardgame-memory-card>
    </template>
  </template>

  <script>
    Polymer({
      is: 'boardgame-render-game-memory',
      properties: {
        state: Object,
        expandedState: Object,
        diagram : String,
        computedCards : {
          type: Array,
          computed: 'computeCards(expandedState.Game.HiddenCards, expandedState.Game.RevealedCards)'
        }
      },
      computeCards : function(hidden, revealed) {
        let result = [];
        for (let i = 0; i < hidden.length; i++) {
          result.push(hidden[i]);
          if (!result[i]) {
            result[i] = revealed[i];
          }
        }
        return result;
      },
      IsCurrentPlayer : function(i) {
        return (i == this.expandedState.Game.CurrentPlayer) ? "CURRENT" : "";
      },
      Exists: function(item) {
        return (item) ? true : false
      },
    });
  </script>
</dom-module>
